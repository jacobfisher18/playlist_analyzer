(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{34:function(e,t,r){e.exports=r(61)},61:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(29),o=r.n(c),i=r(3),u=r(70),s=r(73),l=r(16),f=r(5),p=r.n(f),m=r(7),d=r(30),b=r(9),h=function(e){return new Promise(function(t){return setTimeout(t,e)})},y=r(31);function v(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw c}}}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w="https://api.spotify.com/v1/me/playlists?&limit=".concat(50),x=function(e){return"https://api.spotify.com/v1/playlists/".concat(e,"/tracks")},k=function(){var e=Object(m.a)(p.a.mark(function e(t,r){var n,a,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 2:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.json());case 7:if(429!==n.status){e.next=22;break}if(a=n.headers.get("retry-after")){e.next=11;break}throw new Error("Rate limited but could not get retry-after value");case 11:if(!((c=parseInt(a))>10)){e.next=14;break}throw new Error("Rate limited with a long retry-after of ".concat(c," seconds, not retrying"));case 14:return console.log("Rate limited, retrying in ".concat(c," seconds")),e.next=17,h(1e3*c);case 17:return e.next=19,k(t,r);case 19:return e.abrupt("return",e.sent);case 22:throw new Error("Recieved ".concat(n.status," when fetching"));case 23:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),E=function(){var e=Object(m.a)(p.a.mark(function e(t){var r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k("https://api.spotify.com/v1/me",t);case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error getting the current user profile",e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(m.a)(p.a.mark(function e(t){var r,n,a,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=[],n=!0,a=w;case 4:if(!n){e.next=14;break}return e.next=7,k(a,t);case 7:return c=e.sent,r.push.apply(r,Object(b.a)(c.items)),c.next?a=c.next:n=!1,e.next=12,h(250);case 12:e.next=4;break;case 14:return e.abrupt("return",r);case 17:return e.prev=17,e.t0=e.catch(0),console.error("Error getting all user playlists",e.t0),e.abrupt("return",null);case 21:case"end":return e.stop()}},e,null,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(m.a)(p.a.mark(function e(t,r){var n,a,c,o,i;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=Object(y.chunk)(r,10),c=v(a),e.prev=3,c.s();case 5:if((o=c.n()).done){e.next=11;break}return i=o.value,e.next=9,Promise.all(i.map(function(){var e=Object(m.a)(p.a.mark(function e(r){var a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(t,r.id);case 2:if(a=e.sent){e.next=6;break}return console.error("Error fetching all tracks in all playlists"),e.abrupt("return");case 6:n[r.name]=a;case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),c.e(e.t0);case 16:return e.prev=16,c.f(),e.finish(16);case 19:return e.abrupt("return",n);case 20:case"end":return e.stop()}},e,null,[[3,13,16,19]])}));return function(t,r){return e.apply(this,arguments)}}(),O=function(){var e=Object(m.a)(p.a.mark(function e(t,r){var n,a,c,o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[],a=!0,c=x(r);case 4:if(!a){e.next=12;break}return e.next=7,k(c,t);case 7:o=e.sent,n.push.apply(n,Object(b.a)(o.items)),o.next?c=o.next:a=!1,e.next=4;break;case 12:return e.abrupt("return",n);case 15:return e.prev=15,e.t0=e.catch(0),console.error("Error getting tracks for playlist ".concat(r),e.t0),e.abrupt("return",null);case 19:case"end":return e.stop()}},e,null,[[0,15]])}));return function(t,r){return e.apply(this,arguments)}}();function A(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw c}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C=r(23),T=r(74),I=r(75),L=r(67),R=r(76),z=r(63),D=r(77);function P(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){i=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(i)throw c}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N=function(e){var t=Object(n.useState)([]),r=Object(i.a)(t,2),c=r[0],o=r[1],u=Object(n.useState)(""),s=Object(i.a)(u,2),l=s[0],f=s[1],b=function(e){var t=Object(n.useState)([]),r=Object(i.a)(t,2),a=r[0],c=r[1],o=Object(n.useState)(!1),u=Object(i.a)(o,2),s=u[0],l=u[1],f=Object(n.useState)(!1),b=Object(i.a)(f,2),h=b[0],y=b[1];return Object(n.useEffect)(function(){!function(){var t=Object(m.a)(p.a.mark(function t(){var r,n,a,o,u,s,f,m,b,h,v,g,w;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return l(!0),t.next=3,j(e);case 3:if(null!==(r=t.sent)){t.next=8;break}return l(!1),y(!0),t.abrupt("return");case 8:if(r.length){t.next=13;break}return console.error("Did not find any playlists."),l(!1),y(!0),t.abrupt("return");case 13:return t.next=15,S(e,r);case 15:if(null!==(n=t.sent)){t.next=20;break}return l(!1),y(!0),t.abrupt("return");case 20:if(!Object.values(n).every(function(e){return 0===e.length})){t.next=25;break}return console.error("Did not find any tracks in any playlists."),l(!1),y(!0),t.abrupt("return");case 25:a=[],o=0,u=Object.entries(n);case 27:if(!(o<u.length)){t.next=55;break}s=u[o],f=Object(i.a)(s,2),m=f[0],b=f[1],h=A(b),t.prev=33,h.s();case 35:if((v=h.n()).done){t.next=44;break}if(g=v.value,(w=g.track).name&&w.artists&&w.album&&w.id){t.next=41;break}return console.error("Track does not have expected data"),t.abrupt("continue",42);case 41:a.push(Object(d.a)({},w,{playlistName:m}));case 42:t.next=35;break;case 44:t.next=49;break;case 46:t.prev=46,t.t0=t.catch(33),h.e(t.t0);case 49:return t.prev=49,h.f(),t.finish(49);case 52:o++,t.next=27;break;case 55:c(a),l(!1);case 57:case"end":return t.stop()}},t,null,[[33,46,49,52]])}));return function(){return t.apply(this,arguments)}}()()},[]),{allTracks:a,loading:s,error:h}}(e.accessToken),h=b.allTracks,y=b.loading,v=b.error;Object(n.useEffect)(function(){g()},[h]);var g=function(){var e,t=[],r=P(h);try{for(r.s();!(e=r.n()).done;){var n=e.value,a=n.name.toLowerCase().includes(l.toLowerCase()),c=n.artists.map(function(e){return e.name}).join().toLowerCase().includes(l.toLowerCase()),i=n.album.name.toLowerCase().includes(l.toLowerCase());(a||c||i)&&t.push(n)}}catch(u){r.e(u)}finally{r.f()}o(t)};return v?a.a.createElement(C.a,null,"There was an error retrieving tracks from Spotify."):a.a.createElement(T.a,{p:"sm"},a.a.createElement(I.a,{order:1},"Spotify Search"),a.a.createElement(L.a,{h:"sm"}),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g()}},a.a.createElement(R.a,{disabled:y,placeholder:"Search a track name, artist, or album...",value:l,onChange:function(e){return f(e.currentTarget.value)}})),a.a.createElement(L.a,{h:"xl"}),y?a.a.createElement(T.a,{style:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:100}},a.a.createElement(z.a,{variant:"bars"}),a.a.createElement(L.a,{h:"sm"}),a.a.createElement(I.a,{order:5},"Loading tracks from Spotify")):a.a.createElement(a.a.Fragment,null,a.a.createElement(I.a,{order:5},h.length," total tracks \u2022 ",c.length," filtered tracks"),a.a.createElement(L.a,{h:"sm"}),a.a.createElement("div",null,a.a.createElement(D.a,null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Playlist"),a.a.createElement("th",null,"Title"),a.a.createElement("th",null,"Artist"),a.a.createElement("th",null,"Album"))),a.a.createElement("tbody",null,c?c.slice(0,500).map(function(e){return a.a.createElement("tr",{key:"".concat(e.playlistName,"-").concat(e.id)},a.a.createElement("td",null,e.playlistName),a.a.createElement("td",null,e.name),a.a.createElement("td",null,e.artists.map(function(e){return e.name}).join(", ")),a.a.createElement("td",null,e.album.name))}):null)))))},$=r(68),G=r(69),M=r(71),B=r(72);var F=function(e){var t=e.user,r=Object($.b)(),n=r.colorScheme,c=r.toggleColorScheme,o="dark"===n;return a.a.createElement(T.a,{py:"lg",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingLeft:0,paddingRight:0}},a.a.createElement(T.a,{style:{margin:0}},a.a.createElement(G.a,{size:"md",checked:o,onChange:function(){return c()},onLabel:"LIGHT",offLabel:"DARK"})),a.a.createElement(T.a,{style:{display:"flex",flexDirection:"row",alignItems:"center",margin:0}},t&&t.images?a.a.createElement(M.a,{src:t.images[0].url||"",radius:"xl"}):a.a.createElement("span",null),a.a.createElement(L.a,{w:"md"}),a.a.createElement(C.a,null,t?t.display_name:""),a.a.createElement(L.a,{w:"md"}),a.a.createElement(B.a,{onClick:function(){return e.logout()}},"Log Out")))},H=Object(l.b)(function(e){var t=Object(n.useState)(e.cookies.get("access_token")||""),r=Object(i.a)(t,2),c=r[0],o=r[1],u=Object(n.useState)(null),s=Object(i.a)(u,2),l=s[0],f=s[1];Object(n.useEffect)(function(){!function(){var t=Object(m.a)(p.a.mark(function t(){var r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(c){t.next=4;break}e.history.push("/"),t.next=13;break;case 4:return t.next=6,E(c);case 6:if(!(r=t.sent)){t.next=11;break}f(r),t.next=13;break;case 11:return t.next=13,d();case 13:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},[]);var d=function(){var t=Object(m.a)(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cookies.remove("access_token");case 2:o(""),e.history.push("/");case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return a.a.createElement(a.a.Fragment,null,a.a.createElement(F,{user:l,logout:d.bind(void 0)}),a.a.createElement(N,{accessToken:c}))}),J=r(32),V=r.n(J),K="bc800faa1cb3438da94f230ba04a1e1b",W="https://jacobfisher18.github.io/playlist_analyzer/";function q(){var e=new Uint8Array(32);return"undefined"!==typeof window&&window.crypto&&window.crypto.getRandomValues&&window.crypto.getRandomValues(e),Array.from(e,function(e){return e.toString(16).padStart(2,"0")}).join("")}function Q(e){for(var t=new Uint8Array(e),r="",n=0;n<t.length;n++)r+=String.fromCharCode(t[n]);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function X(e){return Y.apply(this,arguments)}function Y(){return(Y=Object(m.a)(p.a.mark(function e(t){var r,n,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=new TextEncoder,n=r.encode(t),e.next=4,crypto.subtle.digest("SHA-256",n);case 4:return a=e.sent,e.abrupt("return",Q(a));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Z=function(){var e=Object(m.a)(p.a.mark(function e(){var t,r,n,a;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=q(),e.next=3,X(t);case 3:r=e.sent,"undefined"!==typeof sessionStorage&&sessionStorage.setItem("spotify_code_verifier",t),n=new URLSearchParams({response_type:"code",client_id:K,scope:"user-read-private user-read-email playlist-read-private",redirect_uri:W,code_challenge_method:"S256",code_challenge:r,show_dialog:"true"}),a="https://accounts.spotify.com/authorize?".concat(n.toString()),window.location.href=a;case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=Object(m.a)(p.a.mark(function e(t){var r,n,a,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r="undefined"!==typeof sessionStorage?sessionStorage.getItem("spotify_code_verifier"):null){e.next=3;break}return e.abrupt("return",null);case 3:return n=new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:W,client_id:K,code_verifier:r}),e.next=6,fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n.toString()});case 6:if((a=e.sent).ok){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,a.json();case 11:return c=e.sent,"undefined"!==typeof sessionStorage&&sessionStorage.removeItem("spotify_code_verifier"),e.abrupt("return",c.access_token||null);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),te="#2dc760",re=Object(l.b)(function(e){return Object(n.useEffect)(function(){!function(){var t=Object(m.a)(p.a.mark(function t(){var r,n,a;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=V.a.parse(location.search),!(n="string"===typeof r.code?r.code:"")){t.next=9;break}return t.next=5,ee(n);case 5:(a=t.sent)&&(e.cookies.set("access_token",a),e.history.replace("/home")),t.next=10;break;case 9:e.cookies.get("access_token")&&e.history.push("/home");case 10:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},[]),a.a.createElement("div",{style:{position:"fixed",width:"100%",height:"100%",textAlign:"center",paddingTop:120,margin:0,backgroundImage:"linear-gradient(-116deg, #b873ac 5%, #8bb2e2 100%)"}},a.a.createElement(T.a,{style:{backgroundColor:"white",width:500,padding:50,borderRadius:5,boxShadow:"4px 4px 4px rgba(0,0,0,0.08)"}},a.a.createElement(I.a,{order:3,color:te},"Spotify"),a.a.createElement(L.a,{h:"xs"}),a.a.createElement(I.a,{order:1,color:"#555555"},"Playlist Search"),a.a.createElement(L.a,{h:"lg"}),a.a.createElement(C.a,{color:"#555555"},"Search all your tracks across all your playlists at once"),a.a.createElement(L.a,{h:"xl"}),a.a.createElement(B.a,{onClick:function(){return Z()},style:{backgroundColor:te,borderRadius:100,borderWidth:0}},"Login with Spotify")))}),ne=r(27),ae=function(){var e=Object(n.useState)("dark"),t=Object(i.a)(e,2),r=t[0],c=t[1];return a.a.createElement(l.a,null,a.a.createElement($.a,{colorScheme:r,toggleColorScheme:function(e){return c(e||("dark"===r?"light":"dark"))}},a.a.createElement(ne.a,{theme:{colorScheme:r,colors:{primary:[te,te,te,te,te,te,te,te,te,te]},primaryColor:"primary"},withGlobalStyles:!0,withNormalizeCSS:!0},a.a.createElement(u.a,{basename:"/playlist_analyzer"},a.a.createElement("div",null,a.a.createElement(s.a,{path:"/",exact:!0,component:re}),a.a.createElement(s.a,{path:"/home",component:H}))))))};o.a.render(a.a.createElement(ae,null),document.getElementById("root"))}},[[34,2,1]]]);
//# sourceMappingURL=main.09170917.chunk.js.map