(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{33:function(e,t,r){e.exports=r(58)},58:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(29),o=r.n(c),l=r(3),u=r(67),i=r(70),s=r(16),f=r(6),p=r.n(f),m=r(9),b=r(30),h=r(8),d=function(e){return new Promise(function(t){return setTimeout(t,e)})};function y(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return v(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw c}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g="https://api.spotify.com/v1/me/playlists?&limit=".concat(50),E=function(e){return"https://api.spotify.com/v1/playlists/".concat(e,"/tracks")},k=function(){var e=Object(m.a)(p.a.mark(function e(t,r){var n,a,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 2:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.json());case 7:if(429!==n.status){e.next=22;break}if(a=n.headers.get("retry-after")){e.next=11;break}throw new Error("Rate limited but could not get retry-after value");case 11:if(!((c=parseInt(a))>10)){e.next=14;break}throw new Error("Rate limited with a long retry-after of ".concat(c," seconds, not retrying"));case 14:return console.log("Rate limited, retrying in ".concat(c," seconds")),e.next=17,d(1e3*c);case 17:return e.next=19,k(t,r);case 19:return e.abrupt("return",e.sent);case 22:throw new Error("Recieved ".concat(n.status," when fetching"));case 23:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),x=function(){var e=Object(m.a)(p.a.mark(function e(t){var r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,k("https://api.spotify.com/v1/me",t);case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error getting the current user profile",e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(m.a)(p.a.mark(function e(t){var r,n,a,c;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=[],n=!0,a=g;case 4:if(!n){e.next=14;break}return e.next=7,k(a,t);case 7:return c=e.sent,r.push.apply(r,Object(h.a)(c.items)),c.next?a=c.next:n=!1,e.next=12,d(250);case 12:e.next=4;break;case 14:return e.abrupt("return",r);case 17:return e.prev=17,e.t0=e.catch(0),console.error("Error getting all user playlists",e.t0),e.abrupt("return",null);case 21:case"end":return e.stop()}},e,null,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(m.a)(p.a.mark(function e(t,r){var n,a,c,o,l,u,i,s,f;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=[],c=y(r);try{for(c.s();!(o=c.n()).done;)l=o.value,n.push(O(t,l.id)),a.push(l.name)}catch(p){c.e(p)}finally{c.f()}return e.next=6,Promise.all(n);case 6:if(u=e.sent,i=u.every(function(e){return null!==e}),u.length===a.length&&i){e.next=11;break}return console.error("Error fetching all tracks in all playlists"),e.abrupt("return",null);case 11:for(s={},f=0;f<u.length;f++)s[a[f]]=u[f];return e.abrupt("return",s);case 14:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),O=function(){var e=Object(m.a)(p.a.mark(function e(t,r){var n,a,c,o;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[],a=!0,c=E(r);case 4:if(!a){e.next=12;break}return e.next=7,k(c,t);case 7:o=e.sent,n.push.apply(n,Object(h.a)(o.items)),o.next?c=o.next:a=!1,e.next=4;break;case 12:return e.abrupt("return",n);case 15:return e.prev=15,e.t0=e.catch(0),console.error("Error getting tracks for playlist ".concat(r),e.t0),e.abrupt("return",null);case 19:case"end":return e.stop()}},e,null,[[0,15]])}));return function(t,r){return e.apply(this,arguments)}}();function S(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw c}}}}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C=r(19),I=r(71),T=r(72),L=r(64),_=r(73),R=r(60),D=r(74);function z(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw c}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N=function(e){var t=Object(n.useState)([]),r=Object(l.a)(t,2),c=r[0],o=r[1],u=Object(n.useState)(""),i=Object(l.a)(u,2),s=i[0],f=i[1],h=function(e){var t=Object(n.useState)([]),r=Object(l.a)(t,2),a=r[0],c=r[1],o=Object(n.useState)(!1),u=Object(l.a)(o,2),i=u[0],s=u[1],f=Object(n.useState)(!1),h=Object(l.a)(f,2),d=h[0],y=h[1];return Object(n.useEffect)(function(){!function(){var t=Object(m.a)(p.a.mark(function t(){var r,n,a,o,u,i,f,m,h,d,v,g,E;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s(!0),t.next=3,w(e);case 3:if(null!==(r=t.sent)){t.next=8;break}return s(!1),y(!0),t.abrupt("return");case 8:if(r.length){t.next=13;break}return console.error("Did not find any playlists."),s(!1),y(!0),t.abrupt("return");case 13:return t.next=15,j(e,r);case 15:if(null!==(n=t.sent)){t.next=20;break}return s(!1),y(!0),t.abrupt("return");case 20:if(!Object.values(n).every(function(e){return 0===e.length})){t.next=25;break}return console.error("Did not find any tracks in any playlists."),s(!1),y(!0),t.abrupt("return");case 25:a=[],o=0,u=Object.entries(n);case 27:if(!(o<u.length)){t.next=55;break}i=u[o],f=Object(l.a)(i,2),m=f[0],h=f[1],d=S(h),t.prev=33,d.s();case 35:if((v=d.n()).done){t.next=44;break}if(g=v.value,(E=g.track).name&&E.artists&&E.album&&E.id){t.next=41;break}return console.error("Track does not have expected data"),t.abrupt("continue",42);case 41:a.push(Object(b.a)({},E,{playlistName:m}));case 42:t.next=35;break;case 44:t.next=49;break;case 46:t.prev=46,t.t0=t.catch(33),d.e(t.t0);case 49:return t.prev=49,d.f(),t.finish(49);case 52:o++,t.next=27;break;case 55:c(a),s(!1);case 57:case"end":return t.stop()}},t,null,[[33,46,49,52]])}));return function(){return t.apply(this,arguments)}}()()},[]),{allTracks:a,loading:i,error:d}}(e.accessToken),d=h.allTracks,y=h.loading,v=h.error;Object(n.useEffect)(function(){g()},[d]);var g=function(){var e,t=[],r=z(d);try{for(r.s();!(e=r.n()).done;){var n=e.value,a=n.name.toLowerCase().includes(s.toLowerCase()),c=n.artists.map(function(e){return e.name}).join().toLowerCase().includes(s.toLowerCase()),l=n.album.name.toLowerCase().includes(s.toLowerCase());(a||c||l)&&t.push(n)}}catch(u){r.e(u)}finally{r.f()}o(t)};return v?a.a.createElement(C.a,null,"There was an error retrieving tracks from Spotify."):a.a.createElement(I.a,{p:"sm"},a.a.createElement(T.a,{order:1},"Spotify Search"),a.a.createElement(L.a,{h:"sm"}),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g()}},a.a.createElement(_.a,{disabled:y,placeholder:"Search a track name, artist, or album...",value:s,onChange:function(e){return f(e.currentTarget.value)}})),a.a.createElement(L.a,{h:"xl"}),y?a.a.createElement(I.a,{style:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:100}},a.a.createElement(R.a,{variant:"bars"}),a.a.createElement(L.a,{h:"sm"}),a.a.createElement(T.a,{order:5},"Loading tracks from Spotify")):a.a.createElement(a.a.Fragment,null,a.a.createElement(T.a,{order:5},d.length," total tracks \u2022 ",c.length," filtered tracks"),a.a.createElement(L.a,{h:"sm"}),a.a.createElement("div",null,a.a.createElement(D.a,null,a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Playlist"),a.a.createElement("th",null,"Title"),a.a.createElement("th",null,"Artist"),a.a.createElement("th",null,"Album"))),a.a.createElement("tbody",null,c?c.slice(0,500).map(function(e){return a.a.createElement("tr",{key:"".concat(e.playlistName,"-").concat(e.id)},a.a.createElement("td",null,e.playlistName),a.a.createElement("td",null,e.name),a.a.createElement("td",null,e.artists.map(function(e){return e.name}).join(", ")),a.a.createElement("td",null,e.album.name))}):null)))))},P=r(65),G=r(66),M=r(68),$=r(69);var B=function(e){var t=e.user,r=Object(P.b)(),n=r.colorScheme,c=r.toggleColorScheme,o="dark"===n;return a.a.createElement(I.a,{py:"lg",style:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingLeft:0,paddingRight:0}},a.a.createElement(I.a,{style:{margin:0}},a.a.createElement(G.a,{size:"md",checked:o,onChange:function(){return c()},onLabel:"LIGHT",offLabel:"DARK"})),a.a.createElement(I.a,{style:{display:"flex",flexDirection:"row",alignItems:"center",margin:0}},t&&t.images?a.a.createElement(M.a,{src:t.images[0].url||"",radius:"xl"}):a.a.createElement("span",null),a.a.createElement(L.a,{w:"md"}),a.a.createElement(C.a,null,t?t.display_name:""),a.a.createElement(L.a,{w:"md"}),a.a.createElement($.a,{onClick:function(){return e.logout()}},"Log Out")))},F=Object(s.b)(function(e){var t=Object(n.useState)(e.cookies.get("access_token")||""),r=Object(l.a)(t,2),c=r[0],o=r[1],u=Object(n.useState)(null),i=Object(l.a)(u,2),s=i[0],f=i[1];Object(n.useEffect)(function(){!function(){var t=Object(m.a)(p.a.mark(function t(){var r;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(c){t.next=4;break}e.history.push("/"),t.next=13;break;case 4:return t.next=6,x(c);case 6:if(!(r=t.sent)){t.next=11;break}f(r),t.next=13;break;case 11:return t.next=13,b();case 13:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()()},[]);var b=function(){var t=Object(m.a)(p.a.mark(function t(){return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.cookies.remove("access_token");case 2:o(""),e.history.push("/");case 4:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return a.a.createElement(a.a.Fragment,null,a.a.createElement(B,{user:s,logout:b.bind(void 0)}),a.a.createElement(N,{accessToken:c}))}),J=r(31),H=r.n(J),K="https://accounts.spotify.com/authorize?response_type=token"+"&client_id=".concat("bc800faa1cb3438da94f230ba04a1e1b")+"&scope=".concat(encodeURIComponent("user-read-private user-read-email playlist-read-private"))+"&redirect_uri=".concat(encodeURIComponent("https://jacobfisher18.github.io/playlist_analyzer/"))+"&show_dialog=true",W="#2dc760",q=Object(s.b)(function(e){return Object(n.useEffect)(function(){var t=H.a.parse(location.hash).access_token||"";t?(e.cookies.set("access_token",t),e.history.push("/home")):e.cookies.get("access_token")&&e.history.push("/home")},[]),a.a.createElement("div",{style:{position:"fixed",width:"100%",height:"100%",textAlign:"center",paddingTop:120,margin:0,backgroundImage:"linear-gradient(-116deg, #b873ac 5%, #8bb2e2 100%)"}},a.a.createElement(I.a,{style:{backgroundColor:"white",width:500,padding:50,borderRadius:5,boxShadow:"4px 4px 4px rgba(0,0,0,0.08)"}},a.a.createElement(T.a,{order:3,color:W},"Spotify"),a.a.createElement(L.a,{h:"xs"}),a.a.createElement(T.a,{order:1,color:"#555555"},"Playlist Search"),a.a.createElement(L.a,{h:"lg"}),a.a.createElement(C.a,{color:"#555555"},"Search all your tracks across all your playlists at once"),a.a.createElement(L.a,{h:"xl"}),a.a.createElement($.a,{onClick:function(){window.location=K},style:{backgroundColor:W,borderRadius:100,borderWidth:0}},"Login with Spotify")))}),Q=r(27),V=function(){var e=Object(n.useState)("dark"),t=Object(l.a)(e,2),r=t[0],c=t[1];return a.a.createElement(s.a,null,a.a.createElement(P.a,{colorScheme:r,toggleColorScheme:function(e){return c(e||("dark"===r?"light":"dark"))}},a.a.createElement(Q.a,{theme:{colorScheme:r,colors:{primary:[W,W,W,W,W,W,W,W,W,W]},primaryColor:"primary"},withGlobalStyles:!0,withNormalizeCSS:!0},a.a.createElement(u.a,{basename:"/playlist_analyzer"},a.a.createElement("div",null,a.a.createElement(i.a,{path:"/",exact:!0,component:q}),a.a.createElement(i.a,{path:"/home",component:F}))))))};o.a.render(a.a.createElement(V,null),document.getElementById("root"))}},[[33,2,1]]]);
//# sourceMappingURL=main.9756844f.chunk.js.map