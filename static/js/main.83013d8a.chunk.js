(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{16:function(e,t,r){e.exports=r.p+"static/media/spinner.8b9a5cd1.gif"},20:function(e,t,r){e.exports=r(58)},25:function(e,t,r){},32:function(e,t,r){},34:function(e,t,r){},36:function(e,t,r){},50:function(e,t,r){},52:function(e,t,r){},58:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(15),s=r.n(c),o=(r(25),r(6)),i=r(7),l=r(9),u=r(8),f=r(3),p=r(61),m=r(62),h=r(10),y=r(2),d=r.n(y),b=r(4),v=r(19),k=r(16),g=r.n(k),E=(r(32),r(14)),T=function(e){return new Promise(function(t){return setTimeout(t,e)})};function x(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,c=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw c}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var w="https://api.spotify.com/v1/me/playlists?&limit=".concat(50),j=function(e){return"https://api.spotify.com/v1/playlists/".concat(e,"/tracks")},O=function(){var e=Object(b.a)(d.a.mark(function e(t,r){var n,a,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(r)}});case 2:if(200!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.json());case 7:if(429!==n.status){e.next=22;break}if(a=n.headers.get("retry-after")){e.next=11;break}throw new Error("Rate limited but could not get retry-after value");case 11:if(!((c=parseInt(a))>10)){e.next=14;break}throw new Error("Rate limited with a long retry-after of ".concat(c," seconds, not retrying"));case 14:return console.log("Rate limited, retrying in ".concat(c," seconds")),e.next=17,T(1e3*c);case 17:return e.next=19,O(t,r);case 19:return e.abrupt("return",e.sent);case 22:throw new Error("Recieved ".concat(n.status," when fetching"));case 23:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),N=function(){var e=Object(b.a)(d.a.mark(function e(t){var r;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O("https://api.spotify.com/v1/me",t);case 3:return r=e.sent,e.abrupt("return",r);case 7:return e.prev=7,e.t0=e.catch(0),console.error("Error getting the current user profile",e.t0),e.abrupt("return",null);case 11:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(b.a)(d.a.mark(function e(t){var r,n,a,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=[],n=!0,a=w;case 4:if(!n){e.next=14;break}return e.next=7,O(a,t);case 7:return c=e.sent,r.push.apply(r,Object(E.a)(c.items)),c.next?a=c.next:n=!1,e.next=12,T(250);case 12:e.next=4;break;case 14:return e.abrupt("return",r);case 17:return e.prev=17,e.t0=e.catch(0),console.error("Error getting all user playlists",e.t0),e.abrupt("return",null);case 21:case"end":return e.stop()}},e,null,[[0,17]])}));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(b.a)(d.a.mark(function e(t,r){var n,a,c,s,o,i,l,u,f;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=[],c=x(r);try{for(c.s();!(s=c.n()).done;)o=s.value,n.push(L(t,o.id)),a.push(o.name)}catch(p){c.e(p)}finally{c.f()}return e.next=6,Promise.all(n);case 6:if(i=e.sent,l=i.every(function(e){return null!==e}),i.length===a.length&&l){e.next=11;break}return console.error("Error fetching all tracks in all playlists"),e.abrupt("return",null);case 11:for(u={},f=0;f<i.length;f++)u[a[f]]=i[f];return e.abrupt("return",u);case 14:case"end":return e.stop()}},e)}));return function(t,r){return e.apply(this,arguments)}}(),L=function(){var e=Object(b.a)(d.a.mark(function e(t,r){var n,a,c,s;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=[],a=!0,c=j(r);case 4:if(!a){e.next=12;break}return e.next=7,O(c,t);case 7:s=e.sent,n.push.apply(n,Object(E.a)(s.items)),s.next?c=s.next:a=!1,e.next=4;break;case 12:return e.abrupt("return",n);case 15:return e.prev=15,e.t0=e.catch(0),console.error("Error getting tracks for playlist ".concat(r),e.t0),e.abrupt("return",null);case 19:case"end":return e.stop()}},e,null,[[0,15]])}));return function(t,r){return e.apply(this,arguments)}}();function R(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,o=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){o=!0,c=e},f:function(){try{s||null==r.return||r.return()}finally{if(o)throw c}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var I=function(e){Object(l.a)(r,e);var t=B(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).state={playlists:[],playlistNameToTracksMap:{},filteredTracks:[],searchText:"",loading:!1,error:!1},n}return Object(i.a)(r,[{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t,r,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.next=3,S(this.props.access_token);case 3:if(null!==(t=e.sent)){e.next=9;break}return this.setState({loading:!1,error:!0}),e.abrupt("return");case 9:if(0!==t.length){e.next=13;break}return console.error("Did not find any playlists."),this.setState({loading:!1,error:!0}),e.abrupt("return");case 13:return e.next=15,A(this.props.access_token,t);case 15:if(null!==(r=e.sent)){e.next=21;break}return this.setState({loading:!1,error:!0}),e.abrupt("return");case 21:Object.values(r).every(function(e){return 0===e.length})&&(console.error("Did not find any tracks in any playlists."),this.setState({loading:!1,error:!0}));case 22:this.setState({playlistNameToTracksMap:r},function(){n.applyFilter(function(){return n.setState({loading:!1})})});case 23:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"applyFilter",value:function(e){for(var t=this.state,r=t.playlistNameToTracksMap,n=t.searchText,a=[],c=0,s=Object.entries(r);c<s.length;c++){var o,i=s[c],l=Object(v.a)(i,2),u=l[0],f=R(l[1]);try{for(f.s();!(o=f.n()).done;){var p=o.value.track;if(p)if(p.name&&p.artists&&p.album&&p.id){var m=p.name.toLowerCase().includes(n.toLowerCase()),h=p.artists.map(function(e){return e.name}).join(", "),y=h.toLowerCase().includes(n.toLowerCase()),d=p.album.name.toLowerCase().includes(n.toLowerCase());(m||y||d)&&a.push({key:"".concat(u,"-").concat(p.id),playlistName:u,trackName:p.name,artist:h,album:p.album.name})}else console.error("Track does not have expected data");else console.error("Track does not have expected data")}}catch(b){f.e(b)}finally{f.f()}}this.setState({filteredTracks:a},e)}},{key:"renderFilteredTracks",value:function(){var e=this.state.filteredTracks;return e?e.slice(0,500).map(function(e){return a.a.createElement("tr",{key:e.key,className:"TrackList_Row"},a.a.createElement("td",{className:"Tracklist_Playlist"},e.playlistName),a.a.createElement("td",{className:"Tracklist_Title"},e.trackName),a.a.createElement("td",{className:"Tracklist_Artist_Album Tracklist_Artist"},e.artist),a.a.createElement("td",{className:"Tracklist_Artist_Album Tracklist_Album"},e.album))}):null}},{key:"numTracks",value:function(){var e=this.state.playlistNameToTracksMap;return e?Object.values(e).map(function(e){return e.length}).reduce(function(e,t){return e+t},0):0}},{key:"filterByKey",value:function(e){this.setState(function(t){return{filteredTracks:t.filteredTracks.sort(function(t,r){return t[e].toLowerCase().localeCompare(r[e].toLowerCase())})}})}},{key:"render",value:function(){var e=this;return this.state.error?a.a.createElement("p",null,"ERROR"):this.state.loading?a.a.createElement("div",{className:"centered"},a.a.createElement("img",{src:g.a,className:"Spinner",alt:"loading..."})):a.a.createElement("div",{className:"AllTracks"},a.a.createElement("p",{className:"PlaylistHeader_Name"},"Spotify Search"),a.a.createElement("p",{className:"PlaylistHeader_Subtitle"},a.a.createElement("span",{className:"Bold"},this.numTracks())," total tracks \u2022"," ",a.a.createElement("span",{className:"Bold"},this.state.filteredTracks.length)," ","filtered tracks \u2022"," ",a.a.createElement("span",{className:"Bold"},Object.keys(this.state.playlistNameToTracksMap).length)," ","total playlists"),a.a.createElement("p",{className:"PlaylistHeader_Subtitle"}),a.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.applyFilter()}},a.a.createElement("input",{className:"SearchBar",placeholder:"Search a track name, artist, or album...",type:"text",onChange:function(t){return e.setState({searchText:t.target.value})},value:this.state.searchText})),a.a.createElement("div",null,a.a.createElement("table",{className:"AllTracks_TrackList"},a.a.createElement("tbody",null,a.a.createElement("tr",null,a.a.createElement("th",{className:"TrackList_HeaderCell",onClick:function(){return e.filterByKey("playlistName")}},"PLAYLIST"),a.a.createElement("th",{className:"TrackList_HeaderCell",onClick:function(){return e.filterByKey("trackName")}},"TITLE"),a.a.createElement("th",{className:"TrackList_HeaderCell TrackList_HeaderCell_Artist",onClick:function(){return e.filterByKey("artist")}},"ARTIST"),a.a.createElement("th",{className:"TrackList_HeaderCell TrackList_HeaderCell_Album",onClick:function(){return e.filterByKey("album")}},"ALBUM")),this.renderFilteredTracks()))))}}]),r}(n.Component);r(34);var H=function(e){var t=e.user;return a.a.createElement("div",{className:"Header"},t&&t.images?a.a.createElement("img",{className:"Header_Img",src:t.images[0].url||"",alt:"user img"}):a.a.createElement("span",null),a.a.createElement("p",{className:"Header_Name"},t.display_name),a.a.createElement("button",{type:"button",className:"Header_Logout",onClick:function(){return e.logout()}},"Log Out"))};r(36);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var M=function(e){Object(l.a)(r,e);var t=P(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).state={access_token:n.props.cookies.get("access_token")||"",user:{display_name:"",images:[{url:""}]}},n}return Object(i.a)(r,[{key:"componentDidMount",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.state.access_token){e.next=4;break}this.props.history.push("/"),e.next=13;break;case 4:return e.next=6,N(this.state.access_token);case 6:if(!(t=e.sent)){e.next=11;break}this.setState({user:t}),e.next=13;break;case 11:return e.next=13,this.logout();case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(b.a)(d.a.mark(function e(){var t=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.cookies.remove("access_token");case 2:this.setState({access_token:""},function(){t.props.history.push("/")});case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return a.a.createElement("div",{className:"Home"},a.a.createElement(H,{user:this.state.user,logout:this.logout.bind(this)}),a.a.createElement(I,{access_token:this.state.access_token}))}}]),r}(n.Component),D=Object(h.b)(M),F=r(17),z=r.n(F),K="https://accounts.spotify.com/authorize?response_type=token"+"&client_id=".concat("bc800faa1cb3438da94f230ba04a1e1b")+"&scope=".concat(encodeURIComponent("user-read-private user-read-email playlist-read-private"))+"&redirect_uri=".concat(encodeURIComponent("https://jacobfisher18.github.io/playlist_analyzer/"))+"&show_dialog=true";r(50);function U(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var J=function(e){Object(l.a)(r,e);var t=U(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"componentDidMount",value:function(){var e=this.props.location,t=z.a.parse(e.hash).access_token||"";t?(this.props.cookies.set("access_token",t),this.props.history.push("/home")):this.props.cookies.get("access_token")&&this.props.history.push("/home")}},{key:"render",value:function(){return a.a.createElement("div",{className:"Landing"},a.a.createElement("h3",{className:"Landing_Title_Spotify"},"Spotify"),a.a.createElement("h1",{className:"Landing_Title_Playlist_Analyzer"},"PLAYLIST ANALYZER"),a.a.createElement("h5",{className:"Landing_Title_Web_App"},"A web app by ",a.a.createElement("span",{className:"Landing_Title_Name"},"Jacob Fisher")),a.a.createElement("button",{className:"Landing_Button_Login",onClick:function(){window.location=K}},"LOGIN"))}}]),r}(n.Component),Y=Object(h.b)(J);r(52);function G(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var a=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return Object(u.a)(this,r)}}var $=function(e){Object(l.a)(r,e);var t=G(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(i.a)(r,[{key:"render",value:function(){return a.a.createElement(h.a,null,a.a.createElement(p.a,{basename:"/playlist_analyzer"},a.a.createElement("div",null,a.a.createElement(m.a,{path:"/",exact:!0,component:Y}),a.a.createElement(m.a,{path:"/home",component:D}))))}}]),r}(n.Component);s.a.render(a.a.createElement($,null),document.getElementById("root"))}},[[20,2,1]]]);
//# sourceMappingURL=main.83013d8a.chunk.js.map